(this["webpackJsonpava-frontend"]=this["webpackJsonpava-frontend"]||[]).push([[0],{37:function(e,t,n){e.exports=n(80)},42:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(13),c=n.n(r),s=(n(42),n(2)),i=n.n(s),l=n(8),u=n(4),p=n(5),h=n(7),d=n(6),m=n(17),v=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this)).state={props:e},a}return Object(p.a)(n,[{key:"backendRenamer",value:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.stringify({file:t,newName:n}),e.next=3,fetch("https://ava-backend.herokuapp.com/conversations",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:a,method:"PUT"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleKeyPress",value:function(e){13===e.charCode&&(e.preventDefault(),this.frontendRenamer(e))}},{key:"frontendRenamer",value:function(e){if(""===e.target.value)return console.log("no input");var t=Object(m.a)(this.props.conversations).filter((function(t){return t.id===e.target.placeholder}));return e.target.placeholder=e.target.value,this.backendRenamer(t,e.target.value),t[0].id=e.target.placeholder,e.target.value=""}},{key:"conversationDeleter",value:function(e){var t=Object(m.a)(this.props.conversations),n=t.filter((function(t){return t.id===e})),a=t.indexOf(n[0]);this.props.conversations.splice(a,1),this.setState({conversations:this.props.conversations})}},{key:"clickStopper",value:function(e){e.stopPropagation()}},{key:"buttonClick",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,a,o,r,c,s,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),"delete"!==t.target.id){e.next=11;break}return n=t.target.parentElement.parentElement.firstChild.firstChild[0].placeholder,a=this.props.conversations.filter((function(e){return e.id===n})),o=JSON.stringify({file:a[0].fileName}),this.conversationDeleter(n),e.next=8,fetch("https://ava-backend.herokuapp.com/conversations",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:o,method:"DELETE"});case 8:return e.abrupt("return",e.sent);case 11:if("new"!==t.target.id){e.next=21;break}return r="NewConversation"+Date.now().toString().slice(10),c=r,this.setState({conversations:this.props.conversations.push({id:c,fileName:"".concat(r,".json"),content:"",lastMutation:""})}),s=JSON.stringify({file:r}),e.next=18,fetch("https://ava-backend.herokuapp.com/conversations",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:s,method:"POST"});case 18:return e.abrupt("return",this.setState({conversations:this.props.conversations}));case 21:return l=t.target.parentElement.parentElement.firstChild.firstChild[0].placeholder,e.abrupt("return",this.props.starToggler(l));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowClick",value:function(e){var t=e.target.firstChild.firstChild.firstChild.placeholder;return this.props.onRouteChange(t)}},{key:"openUp",value:function(e){var t=e.target.parentElement.parentElement.firstChild.firstChild.firstChild.placeholder;return this.props.onRouteChange(t)}},{key:"render",value:function(){var e,t=this,n=this.props.conversations;return o.a.createElement("div",{className:"container conv-list-container"},o.a.createElement("div",{className:"row conv-list-ops-row"},o.a.createElement("div",{className:"column conv-list-ops-column"},o.a.createElement("button",{onClick:function(e){t.buttonClick(e)},id:"new",className:"new-button"},"New+"))),o.a.createElement("div",{className:"column conv-list-column"},n.map((function(n,a){return e=localStorage.getItem("".concat(n.id,"-star"))?localStorage.getItem("".concat(n.id,"-star")):"star.svg",o.a.createElement("div",{className:"row conv-list-row",key:"".concat(a),onClick:function(e){return t.rowClick(e)}},o.a.createElement("div",{className:"column conv-title-column",onClick:function(e){t.clickStopper(e)}},o.a.createElement("form",{onSubmit:t.handleSubmit},o.a.createElement("input",{"aria-label":"".concat(n.id,"-input"),id:"conversation-titles",maxLength:"30",placeholder:"".concat(n.id),type:"textarea",onClick:function(e){t.clickStopper(e)},onBlur:function(e){t.frontendRenamer(e)},onKeyPress:function(e){return t.handleKeyPress(e)}}))),o.a.createElement("div",{className:"column conv-buttons-column",onClick:function(e){t.clickStopper(e)}},o.a.createElement("img",{onClick:function(e){t.buttonClick(e)},alt:"star",src:"./assets/".concat(e),id:"star",className:"star-button"}),o.a.createElement("button",{id:"open",onClick:function(e){t.openUp(e)},className:"open-button"},"Open"),o.a.createElement("button",{id:"delete",onClick:function(e){t.buttonClick(e)},className:"delete-button"},"Delete")))}))))}}]),n}(o.a.Component),f=n(14),g=n(34),b=n(35),k=n.n(b),C=new WebSocket("wss://ava-backend.herokuapp.com/"),E=new k.a.Connection(C);var y=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleInput=a.handleInput.bind(Object(f.a)(a)),a.textArea=o.a.createRef(),a}return Object(p.a)(n,[{key:"textEntered",value:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.stringify({text:t,file:n}),e.next=3,fetch("https://ava-backend.herokuapp.com/mutations",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:a,method:"POST"});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"opHandler",value:function(e){var t,n=this,a=this.props.conversations.filter((function(e){return e.id===n.props.route}));Object.keys(e[0]).includes("si")?t="INSERTION @ ".concat(e[0].p,":  ").concat(e[0].si):Object.keys(e[0]).includes("sd")&&(t="DELETION @ ".concat(e[0].p,":  ").concat(e[0].sd)),this.setState({conversations:a[0].lastMutation=t});var o=JSON.stringify({mutation:t,file:a[0].fileName});fetch("https://ava-backend.herokuapp.com/mutations",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:o,method:"PATCH"})}},{key:"componentDidMount",value:function(){var e=this,t=c.a.findDOMNode(this.textArea.current),n=this.props.conversations.filter((function(t){return t.id===e.props.route})),a=(n[0].content,E.get("textPads","".concat(n[0].fileName,".json")));a.on("op",(function(t){return e.opHandler(t)})),a.subscribe((function(e){if(e)throw e;!function(e,t,n){if(null===e.type)return e.create("",n);n()}(a,0,(function(){})),new g(t,a).setup()}))}},{key:"starClick",value:function(e){var t=this.props.currentConversation[0].id;this.props.starToggler(t)}},{key:"handleInput",value:function(e){var t=this.props.currentConversation[0].fileName;this.textEntered(e.target.value,t)}},{key:"render",value:function(){var e,t,n=this,a=this.props.currentConversation,r=a[0].lastMutation;return r&&(r.includes("INSERTION")?e="#4bcc14":r.includes("DELETION")&&(e="#fc845f")),t=localStorage.getItem("".concat(a[0].id,"-star"))?localStorage.getItem("".concat(a[0].id,"-star")):"star.svg",o.a.createElement("div",{className:"container conv-container"},o.a.createElement("div",{className:"row conv-input-ops-row"},o.a.createElement("div",{className:"column conv-input-ops-column"},o.a.createElement("button",{onClick:function(e){n.props.onRouteChange("home")},id:"new",className:"home-button"}," \u2190Home"))),o.a.createElement("div",{className:"column conv-column"},o.a.createElement("div",{className:"row conv-label-row"},o.a.createElement("div",{className:"column conv-label-column"},o.a.createElement("img",{onClick:function(e){n.starClick(e)},alt:"star",src:"./assets/".concat(t),id:"star",className:"star-button"}),o.a.createElement("p",null,"".concat(a[0].id))),o.a.createElement("div",{className:"column conv-last-mutation-column"},o.a.createElement("p",{className:"last-mutation"},o.a.createElement("span",{style:{color:"".concat(e)}},r)))),o.a.createElement("div",{className:"conv-border"}),o.a.createElement("div",{className:"row conv-row"},o.a.createElement("textarea",{ref:this.textArea,doc:this.doc,defaultValue:a[0].content,onBlur:this.handleInput,className:"conv-input"}))))}}]),n}(o.a.Component),N=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"signature",style:{display:"flex",justifyContent:"flex-end"}},o.a.createElement("p",{className:""},"A nonsense project by ",o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://mattseidholz.com",className:"sig-link"},"Matt Seidholz")))}}]),n}(o.a.Component),w=n(36),O=n.n(w),j=(n(79),function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).onRouteChange=function(t){return"home"===t&&(e.setState({currentConversation:""}),e.handleUpdate()),e.setState({route:t,currentConversation:e.state.conversations.filter((function(e){return e.id===t}))})},e.starToggler=function(t){var n,a=e.state.conversations.filter((function(e){return e.id===t}));return n="star-filled.svg"===localStorage.getItem("".concat(a[0].id,"-star"))?"star.svg":"star-filled.svg",localStorage.setItem("".concat(a[0].id,"-star"),"".concat(n)),e.setState({conversations:e.state.conversations})},e.state={conversations:[],route:"home",lastMutation:[],currentConversation:""},e}return Object(p.a)(n,[{key:"getConversations",value:function(){var e=Object(l.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({conversations:[],lastMutation:[]}),e.prev=1,e.next=4,O.a.get("https://ava-backend.herokuapp.com/conversations");case 4:e.sent.data.forEach((function(e){return t.setState({conversations:t.state.conversations.concat(e)})})),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",console.log(e.t0));case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getConversations()}},{key:"handleUpdate",value:function(){this.getConversations()}},{key:"render",value:function(){var e=this.state.route;return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("h1",null,"The Collabatron"),"home"===e?o.a.createElement(v,Object.assign({},this.state,{buttonClick:this.buttonClick,starToggler:this.starToggler,onRouteChange:this.onRouteChange,getConversations:this.getConversations})):o.a.createElement(y,Object.assign({},this.state,{starToggler:this.starToggler,buttonClick:this.buttonClick,onRouteChange:this.onRouteChange,opHandler:this.opHandler}))),o.a.createElement(N,null))}}]),n}(o.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.4008f978.chunk.js.map