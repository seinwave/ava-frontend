{"version":3,"sources":["components/ConversationList/ConversationList.js","components/Connection/Connection.js","components/Conversation/Conversation.js","components/Signature/Signature.js","App.js","serviceWorker.js","index.js"],"names":["ConversationList","props","state","targetConversation","value","bodyObject","JSON","stringify","fetch","headers","body","method","e","charCode","preventDefault","this","frontendRenamer","target","console","log","conversations","filter","c","id","placeholder","backendRenamer","file","newConversations","index","indexOf","splice","setState","stopPropagation","fileName","parentElement","firstChild","conversationDeleter","Date","now","toString","slice","push","conversationName","starToggler","conversation","onRouteChange","star","className","onClick","buttonClick","map","i","localStorage","getItem","key","rowClick","clickStopper","onSubmit","handleSubmit","aria-label","maxLength","type","onBlur","onKeyPress","handleKeyPress","alt","src","openUp","React","Component","webSocket","WebSocket","connection","sharedb","Connection","Conversation","handleInput","bind","textArea","createRef","text","op","lastMutation","route","Object","keys","includes","p","si","sd","ReactDOM","findDOMNode","current","stringData","content","doc","get","fetchSnapshot","err","snapshot","on","opHandler","subscribe","data","callback","create","createIfNeeded","StringBinding","setup","currentConversation","conv","textEntered","spanStyle","starClick","style","color","ref","defaultValue","Signature","display","justifyContent","rel","href","App","handleUpdate","starStatus","setItem","axios","forEach","concat","getConversations","Boolean","window","location","hostname","match","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.f70eb360.chunk.js","sourcesContent":["import React from 'react';\n\n\n\nclass ConversationList extends React.Component {\n    constructor(props) {\n        super();\n        this.state = {\n            props\n        }\n    }\n\n    // renaming conversations on the backend\n    async backendRenamer(targetConversation, value){\n        const bodyObject = JSON.stringify({\n            \"file\": targetConversation,\n            \"newName\": value})\n        return await fetch('https://ava-backend.herokuapp.com/conversations', {\n            headers: { 'Accept': 'application/json',\n            \"Content-Type\": 'application/json',\n            \"Access-Control-Allow-Origin\": \"*\"},\n            body: bodyObject,\n            method: 'PUT'\n            })\n    }\n\n    // if user presses enter,\n    // proceed to change convo name\n    handleKeyPress(e){\n        if (e.charCode ===13){\n            e.preventDefault();\n            this.frontendRenamer(e)\n        }\n    }\n\n    // changing the convo name\n    // on the frontend\n    frontendRenamer(e) {\n        // IF NO USER INPUT\n        // --> BREAK\n        if (e.target.value === ''){\n            return console.log('no input')\n        }\n        // shallow copy of conversations array\n        let conversations = [...this.props.conversations];\n        \n        // filtering the copy, for the conversation\n        // we're trying to edit\n        let targetConversation = conversations.filter(c => c.id === e.target.placeholder);\n\n        e.target.placeholder = e.target.value;\n\n        // firing the rename function, while our\n        // data is freshly targeted\n        this.backendRenamer(targetConversation, e.target.value);\n\n        targetConversation[0].id = e.target.placeholder;\n        // setting our target conversation's id to\n        // to the new name\n        // think this may be causing a bug\n        //targetConversation[0].id = e.target.placeholder;\n        return e.target.value = '';\n\n    }\n\n\n    // delete conversations from frontend\n    conversationDeleter(file){\n        // shallow copy of conversations...\n        // ...just in case\n        const newConversations = [...this.props.conversations];\n\n        // filtering the copy, for the conversation\n        // we're trying to delete\n        let targetConversation = newConversations.filter(c => c.id === file);\n\n        // checking if element is in\n        // conversations array\n        const index = newConversations.indexOf(targetConversation[0])\n\n        // mutating the array with a splice\n        this.props.conversations.splice(index,1)\n\n        // using the index to splice\n        // our conversation array\n        this.setState({conversations: \n            this.props.conversations})\n    }\n\n    // prevents clicks from\n    // bubbling up to rowClick event;\n    clickStopper(e){\n        e.stopPropagation();\n    }\n\n    async buttonClick(e) {\n        e.stopPropagation();\n        if (e.target.id ===\"delete\"){\n            const fileName = e.target.parentElement.parentElement.firstChild.firstChild[0].placeholder;\n            const bodyObject = JSON.stringify({\"file\": fileName})\n    \n            // reflect deletion in frontend\n            this.conversationDeleter(fileName)\n            return await fetch('https://ava-backend.herokuapp.com/conversations', {\n            headers: { 'Accept': 'application/json',\n            \"Content-Type\": 'application/json',\n            \"Access-Control-Allow-Origin\": \"*\"},\n            body: bodyObject,\n            method: 'DELETE'\n            })\n          }\n    \n        else if (e.target.id === \"new\"){\n            const fileName = \"NewConversation\" + Date.now().toString().slice(10)\n            this.setState({conversations: this.props.conversations.push({\"id\":fileName})})\n            const bodyObject = JSON.stringify({\"file\": fileName})\n            await fetch('https://ava-backend.herokuapp.com/conversations', {\n                headers: { 'Accept': 'application/json',\n                \"Content-Type\": 'application/json',\n                \"Access-Control-Allow-Origin\": \"*\"},\n                body: bodyObject,\n                method: 'POST'\n            })\n            this.setState({conversations: this.props.conversations})\n        } \n    \n        else {\n            const conversationName = e.target.parentElement.parentElement.firstChild.firstChild[0].placeholder;\n            return this.props.starToggler(conversationName);\n        }\n    }\n\n    rowClick(e){\n        const conversation = e.target.firstChild.firstChild.firstChild.placeholder\n        return this.props.onRouteChange(conversation)\n    }\n\n    openUp(e){\n        const conversation = e.target.parentElement.parentElement.firstChild.firstChild.firstChild.placeholder;\n        return this.props.onRouteChange(conversation);\n    }\n\n\n    render() {\n        let conversations = this.props.conversations;\n        let star\n        return (\n            <div className = \"container conv-list-container\">\n                <div className = \"row conv-list-ops-row\">\n                    <div className = \"column conv-list-ops-column\">\n                        <button \n                        onClick = {(e) => {this.buttonClick(e)}}\n                        id = \"new\"\n                        className = \"new-button\">New+</button>\n                    </div>\n                </div>\n                <div className = \"column conv-list-column\">\n                    { conversations.map((conversation,i) => {\n                        if (localStorage.getItem(`${conversation.id}-star`)){\n                        star = localStorage.getItem(`${conversation.id}-star`)}\n                        else {star = \"star.svg\"}\n                        return <div \n                        className = \"row conv-list-row\"\n                        key = {`${i}`}\n                        onClick = {(e) => this.rowClick(e)}>\n                        <div className = \"column conv-title-column\"\n                        onClick = {(e) => {this.clickStopper(e)}}>\n                            <form onSubmit = {this.handleSubmit}>\n                                <input\n                                aria-label = {`${conversation.id}-input`}\n                                id = \"conversation-titles\"\n                                maxLength = \"30\"\n                                placeholder = {`${conversation.id}`}\n                                type = \"textarea\"\n                                onClick = {(e) => {this.clickStopper(e)}}\n                                onBlur = {(e) => {this.frontendRenamer(e)}} \n                                onKeyPress = {(e) => this.handleKeyPress(e)}\n                                ></input>\n                            </form>\n                        </div>\n                        <div className = \"column conv-buttons-column\"\n                        onClick = {(e) => {this.clickStopper(e)}}>\n                            <img\n                            onClick = {(e) => {this.buttonClick(e)}}\n                            alt = \"star\"\n                            src = {`./assets/${star}`}\n                            id = \"star\"\n                            className = \"star-button\"/>\n                            <button \n                            id = \"open\"\n                            onClick = {(e) => {this.openUp(e)}}\n                            className = \"open-button\">Open</button>\n                            <button \n                            id = \"delete\"\n                            onClick = {(e) => {this.buttonClick(e)}}\n                            className = \"delete-button\">Delete</button>\n                        </div>\n                    </div>\n                    })}\n                </div>\n            </div>   \n        )\n    }\n}\n\nexport default ConversationList;","// This module exposes a singleton WebSocket connection to ShareDB server.\nimport sharedb from 'sharedb/lib/client';\n\n// Uncomment lines 5 & 6 for use with dev server\n// const host = window.location.host.replace(\"3000\", \"4000\");\n// const webSocket = new WebSocket('ws://' + host);\n\n// Uncomment line 9 for use in deployment\nconst webSocket = new WebSocket('wss://ava-backend.herokuapp.com/');\n\nconst connection = new sharedb.Connection(webSocket);\nexport default connection;\n","import React  from 'react';\nimport ReactDOM from 'react-dom'\nimport * as StringBinding from 'sharedb-string-binding';\nimport connection from '../Connection/Connection'\n\n// If needed, create a new Doc instance\n// for shareDB to communicate with\nfunction createIfNeeded(doc, data, callback){\n    if(doc.type === null){\n        console.log('File does not exist. Creating a blank.')\n        return doc.create('', callback);\n    } else {\n        console.log('File exists. Populating with:', data)\n        callback();\n    }\n}\nclass Conversation extends React.Component {\n    \n    constructor(props) {\n        super(props);\n        this.handleInput = this.handleInput.bind(this);\n        this.textArea = React.createRef();\n    }\n    \n\n    // saves the input to the doc on the\n    // server \n    async textEntered(text, conversation) {\n        const bodyObject = JSON.stringify({\"text\":text, \"file\":conversation});\n        await fetch('https://ava-backend.herokuapp.com/mutations', {\n            headers: { 'Accept': 'application/json',\n            \"Content-Type\": 'application/json',\n            \"Access-Control-Allow-Origin\": \"*\"},\n            body: bodyObject,\n            method: 'POST'\n        })\n    \n    }\n\n    // extracts most recent mutation\n    opHandler(op){\n        let lastMutation;\n        let targetConversation = this.props.conversations.filter(c => c.id === this.props.route);\n\n        if (Object.keys(op[0]).includes('si')){\n            lastMutation = `INSERTION @ ${op[0].p}:  ${op[0].si}`\n        }\n        else if (Object.keys(op[0]).includes('sd')){\n            lastMutation = `DELETION @ ${op[0].p}:  ${op[0].sd}`\n        }\n        this.setState({conversations: targetConversation[0].lastMutation = lastMutation })\n        const bodyObject = JSON.stringify({\"mutation\": lastMutation, \"file\": targetConversation[0].id})\n        fetch('https://ava-backend.herokuapp.com/mutations', {\n            headers: { 'Accept': 'application/json',\n            \"Content-Type\": 'application/json',\n            \"Access-Control-Allow-Origin\": \"*\"},\n            body: bodyObject,\n            method: 'PATCH'\n        })\n    }\n\n\n    componentDidMount(){\n        // Get a reference to the textArea DOM node.\n        const textArea = ReactDOM.findDOMNode(this.textArea.current);\n        let targetConversation = this.props.conversations.filter(c => c.id === this.props.route);\n        let stringData = targetConversation[0].content;\n\n        // Create local Doc instance, mapped\n        // to the current conversation\n        const collection = 'textPads';\n        const doc = connection.get(collection, `${this.props.route}.json`);\n\n        console.log('DOC:', doc);\n\n        connection.fetchSnapshot(collection, `${this.props.route}.json`, (err, snapshot) =>{\n            console.log('SNAPSHOT:', snapshot)\n        })\n\n        // Getting operation details\n        doc.on('op', (op) => {\n            return this.opHandler(op);\n        });\n        \n        // subscribe to the server's updates\n        // on the document\n        doc.subscribe(function(err) {\n            if (err) throw err;\n            createIfNeeded(doc, stringData, () => {    \n            }); \n            const binding = new StringBinding(textArea, doc);\n            binding.setup();\n        });\n    }\n\n\n    starClick(e){\n       const conversation = this.props.currentConversation.id;\n       this.props.starToggler(conversation)\n    }\n\n\n    handleInput(e) {\n        const conv = this.props.currentConversation.id\n        this.textEntered(e.target.value, conv)\n    }\n\n    render() {\n        const { currentConversation } = this.props;\n        const lastMutation = currentConversation[0].lastMutation;\n    \n        // latestMutation is green or red\n        // depending on what it is\n        let spanStyle;\n        if (lastMutation){\n            if(lastMutation.includes('INSERTION')) {\n                spanStyle = '#4bcc14';\n            }\n            else if (lastMutation.includes('DELETION')) {\n                spanStyle =  '#fc845f';\n            }\n        }\n\n        // star is filled or not,\n        // depending on its status\n        let star; \n        if (localStorage.getItem(`${currentConversation[0].id}-star`)){\n            star = localStorage.getItem(`${currentConversation[0].id}-star`)\n        }\n        else {star = \"star.svg\"}\n        \n        return (\n            <div className = \"container conv-container\">\n                <div className = \"row conv-input-ops-row\">\n                    <div className = \"column conv-input-ops-column\">\n                        <button \n                        onClick = {(e) => {this.props.onRouteChange('home')}}\n                        id = \"new\"\n                        className = \"home-button\"> ←Home</button>\n                    </div>\n                </div>\n                <div className = \"column conv-column\">\n                    <div className = \"row conv-label-row\">\n                        <div className = \"column conv-label-column\">\n                            <img\n                            onClick = {(e) => {this.starClick(e)}}\n                            alt = \"star\"\n                            src = {`./assets/${star}`}\n                            id = \"star\"\n                            className = \"star-button\"/> \n                            <p>{`${currentConversation[0].id}`}</p>\n                        </div>\n                        <div className = \"column conv-last-mutation-column\">\n                            <p className = 'last-mutation'>\n                                <span style = {{color: `${spanStyle}`}}>{lastMutation}</span>\n                            </p>\n                        </div>\n                    </div>\n                    <div className = \"conv-border\"></div>\n                    <div className = \"row conv-row\">\n                        <textarea\n                        ref = {this.textArea}\n                        doc = {this.doc}\n                        defaultValue = {currentConversation[0].content}\n                        onBlur = {this.handleInput}\n                        className = \"conv-input\" \n                        >\n                        </textarea>\n                    </div>\n                    \n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Conversation;","import React from 'react';\n\n\n\nclass Signature extends React.Component {\n    render() {\n\n        return (\n            <div className = \"signature\" \n            style = {{display: 'flex', justifyContent: 'flex-end'}}>\n                <p \n                className = ''>A nonsense project by <a \n                target = \"_blank\"\n                rel=\"noopener noreferrer\"\n                href =\"https://mattseidholz.com\" \n                className = 'sig-link'>Matt Seidholz</a>\n                </p>\n            </div>\n        )\n    }\n}\n\nexport default Signature\n","import React from 'react';\nimport ConversationList from './components/ConversationList/ConversationList'\nimport Conversation from './components/Conversation/Conversation'\nimport Signature from './components/Signature/Signature'\nimport axios from 'axios/index';\nimport './App.css';\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n        conversations: [],\n        route: 'home',\n        lastMutation: [],\n        currentConversation: ''\n    }\n  }\n\n\n  async getConversations(){\n    this.setState({conversations: [],\n    lastMutation: []});\n    try {\n      const res = await axios.get('https://ava-backend.herokuapp.com/conversations')\n      res.data.forEach(i => {\n        return this.setState({conversations: this.state.conversations.concat(i) })\n      })\n    }   \n    catch (e) {\n    return console.log(e)\n    }\n  }\n\n\n  onRouteChange = (conversation) =>{\n    // necessary reloading — to populate\n    // frontend conversations with\n    // any changes we've made\n    if (conversation === 'home'){\n      this.setState({currentConversation: ''});   \n      this.handleUpdate();\n    }\n    return this.setState({route: conversation, currentConversation: this.state.conversations.filter(c => c.id === conversation)}); \n  }\n\n   // toggles starred status\n   starToggler = (conversation) => {\n    // filtering the copy, for the conversation\n    // we're trying to star\n    let targetConversation = this.state.conversations.filter(c => c.id === conversation);\n    let starStatus;\n    let localStar = localStorage.getItem(`${targetConversation[0].id}-star`)\n\n    if (localStar === \"star-filled.svg\"){\n       console.log('false')\n        starStatus = \"star.svg\";\n    }\n    else {\n        console.log('true')\n        starStatus = \"star-filled.svg\";\n    }\n    localStorage.setItem(`${targetConversation[0].id}-star`, `${starStatus}`);\n    return this.setState({conversations: this.state.conversations})\n}\n\n\n  componentDidMount(){\n    this.getConversations();\n  }\n\n\n  handleUpdate(){\n    this.getConversations();\n  }\n\n\n  render(){\n\n    const { route } = this.state; \n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <h1>The Collabatron</h1>\n          { route === 'home' ?\n              <ConversationList \n              {...this.state}\n              buttonClick = {this.buttonClick}\n              starToggler = {this.starToggler}\n              onRouteChange = {this.onRouteChange}\n              getConversations = {this.getConversations}/> :\n              <Conversation \n              {...this.state}\n              starToggler = {this.starToggler}\n              buttonClick = {this.buttonClick}\n              onRouteChange = {this.onRouteChange}\n              opHandler = {this.opHandler} />}\n        </header>\n        <Signature />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}